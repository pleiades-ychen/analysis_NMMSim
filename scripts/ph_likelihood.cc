// this version incorporates both low and high gain likelihood

#include <iostream>
#include "TMath.h"

double pdf_n_l(const double);
double pdf_g_l(const double);
double pdf_n_h(const double);
double pdf_g_h(const double);

double ph_likelihood(const vector<double> & ph, const string type, const string gain) {

  double ll = 1.;
  if(gain == "l") {

    if(type == "n") {
      for (int i = 0; i < ph.size(); i++)
	ll *= pdf_n_l(ph[i]);
    }
    else if(type == "g") {
      for (int i = 0; i < ph.size(); i++)
	ll *= pdf_g_l(ph[i]);
    }
    else
      std::cout << "Event type must be \"n\" or \"g\".\n";
    
  }
  else if(gain == "h") {
    
    if(type == "n") {
      for (int i = 0; i < ph.size(); i++)
	ll *= pdf_n_h(ph[i]);
    }
    else if(type == "g") {
      for (int i = 0; i < ph.size(); i++)
	ll *= pdf_g_h(ph[i]);
    }
    else
      std::cout << "Event type must be \"n\" or \"g\".\n";
    
  }
  else
    std::cout << "Gain setting must be \"h\" or \"l\".\n";

  return ll;
}


double pdf_n_l(double Amp) {
//double pdf_n(double * x, double *par) {
//double Amp = x[0];
  double val[300] = {0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00001796, 0.00166640, 0.00575472, 0.00921697, 0.01196160, 0.01340186, 0.01471190, 0.01596591, 0.01691107, 0.01755245, 0.01869777, 0.01888497, 0.01902122, 0.01949903, 0.01956813, 0.02021372, 0.01933232, 0.01974531, 0.01986557, 0.01968727, 0.01985259, 0.01925612, 0.01927993, 0.01908675, 0.01852025, 0.01824454, 0.01839789, 0.01850448, 0.01847717, 0.01787871, 0.01761145, 0.01708502, 0.01711706, 0.01681440, 0.01633932, 0.01631922, 0.01597744, 0.01535205, 0.01511725, 0.01490118, 0.01463718, 0.01378071, 0.01373286, 0.01342840, 0.01304043, 0.01270355, 0.01216936, 0.01224718, 0.01163995, 0.01141564, 0.01079211, 0.01056502, 0.00960541, 0.00992188, 0.00925894, 0.00881885, 0.00860868, 0.00817338, 0.00788047, 0.00743129, 0.00717222, 0.00706386, 0.00667669, 0.00629963, 0.00579820, 0.00568398, 0.00518877, 0.00506580, 0.00486359, 0.00450893, 0.00458137, 0.00409999, 0.00378698, 0.00369152, 0.00363065, 0.00318275, 0.00310985, 0.00307651, 0.00280523, 0.00267848, 0.00257289, 0.00230070, 0.00212155, 0.00189765, 0.00187954, 0.00169594, 0.00165499, 0.00158640, 0.00151643, 0.00129043, 0.00136324, 0.00109398, 0.00111189, 0.00098031, 0.00096359, 0.00089617, 0.00075548, 0.00077581, 0.00076216, 0.00067264, 0.00057160, 0.00058497, 0.00048388, 0.00048769, 0.00045904, 0.00038785, 0.00033163, 0.00029132, 0.00030767, 0.00027266, 0.00022818, 0.00020988, 0.00023142, 0.00016224, 0.00015908, 0.00021963, 0.00014905, 0.00018378, 0.00015026, 0.00011209, 0.00009835, 0.00010865, 0.00006965, 0.00007884, 0.00010550, 0.00011441, 0.00004699, 0.00007197, 0.00004272, 0.00004638, 0.00006250, 0.00005214, 0.00001347, 0.00002665, 0.00002294, 0.00002006, 0.00002322, 0.00005507, 0.00001662, 0.00002953, 0.00002006, 0.00001319, 0.00001950, 0.00000687, 0.00002294, 0.00000659, 0.00000316, 0.00001978, 0.00001922, 0.00001607, 0.00000659, 0.00000316, 0.00000316, 0.00000631, 0.00000659, 0.00000975, 0.00000659, 0.00000631, 0.00000000, 0.00001319, 0.00000659, 0.00000344, 0.00000316, 0.00000316, 0.00000631, 0.00000000, 0.00000000, 0.00000344, 0.00000344, 0.00000000, 0.00000631, 0.00000000, 0.00000000, 0.00000947, 0.00000000, 0.00001003, 0.00000344, 0.00000344, 0.00000659, 0.00000947, 0.00000631, 0.00000000, 0.00000344, 0.00000344, 0.00000316, 0.00000659, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000344, 0.00000344, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000316, 0.00000344, 0.00000000, 0.00000631, 0.00000000, 0.00000687, 0.00000344, 0.00000000, 0.00000000, 0.00000000, 0.00000344, 0.00000316, 0.00000000, 0.00000659, 0.00000316, 0.00000000, 0.00000000, 0.00000344, 0.00000316, 0.00000000, 0.00000344, 0.00000344, 0.00000000, 0.00000344, 0.00000344, 0.00000344, 0.00000000, 0.00000000, 0.00000316, 0.00000000, 0.00000344, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000316, 0.00000000, 0.00000316, 0.00000000, 0.00000000,};
  int i = (int)TMath::Nint((Amp+1.)/2);
  return val[i];
}

double pdf_g_l(double Amp) {
//double pdf_g(double *x, double *par) {
//double Amp = x[0];
  double val[300] = {0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00012889, 0.01502993, 0.04443170, 0.06019722, 0.06405628, 0.06863247, 0.06557105, 0.06271315, 0.05899057, 0.05458895, 0.05050498, 0.04822523, 0.04208372, 0.03692373, 0.03434151, 0.03016305, 0.02917783, 0.02609113, 0.02477718, 0.02145700, 0.01796031, 0.01714130, 0.01351767, 0.01383804, 0.01279392, 0.01048152, 0.01085788, 0.00833533, 0.00724260, 0.00583144, 0.00573152, 0.00514968, 0.00442495, 0.00380015, 0.00265144, 0.00284195, 0.00261878, 0.00208923, 0.00188841, 0.00176983, 0.00208359, 0.00076302, 0.00062480, 0.00067243, 0.00103946, 0.00067243, 0.00045295, 0.00053421, 0.00028110, 0.00031474, 0.00040066, 0.00026244, 0.00036236, 0.00022414, 0.00017652, 0.00018118, 0.00018585, 0.00012889, 0.00013822, 0.00004296, 0.00009526, 0.00000000, 0.00000000, 0.00017652, 0.00013822, 0.00004763, 0.00000000, 0.00017652, 0.00004296, 0.00004763, 0.00004763, 0.00000000, 0.00004763, 0.00004296, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00009059, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00004296, 0.00000000, 0.00004763, 0.00004763, 0.00000000, 0.00008593, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00004296, 0.00004296, 0.00000000, 0.00004763, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00004763, 0.00000000, 0.00004763, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,};

  int i = (int)TMath::Nint((Amp+1.)/2);
  return val[i];
}


double pdf_n_h(double Amp) {
  double val[300] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000927436, 0.00457469, 0.0083602, 0.0106133, 0.0109698, 0.0122399, 0.0126982, 0.0131512, 0.0136847, 0.014603, 0.0145822, 0.0151752, 0.0156189, 0.015812, 0.0153703, 0.0155424, 0.015715, 0.0160199, 0.0157448, 0.0156863, 0.0157199, 0.015294, 0.0158116, 0.0153674, 0.015249, 0.0157607, 0.015303, 0.0155889, 0.0142383, 0.0151035, 0.0142575, 0.0143214, 0.014329, 0.0133933, 0.0133103, 0.014231, 0.0126915, 0.0131704, 0.0127528, 0.0125793, 0.0125667, 0.0123362, 0.011839, 0.0118709, 0.0120838, 0.0116461, 0.011429, 0.0112865, 0.0110752, 0.0106568, 0.0101219, 0.00989635, 0.0103466, 0.00987625, 0.00946453, 0.00967751, 0.00929851, 0.00946036, 0.00899667, 0.00825883, 0.00833345, 0.00873509, 0.00792596, 0.00793604, 0.00799641, 0.00789329, 0.00766606, 0.00751261, 0.00705482, 0.00695588, 0.00662469, 0.00682005, 0.00606712, 0.00602939, 0.00629351, 0.00596147, 0.00617192, 0.00556153, 0.0051381, 0.00478343, 0.0046543, 0.00446733, 0.00452016, 0.00432311, 0.00424765, 0.00396089, 0.00375045, 0.00353076, 0.00360707, 0.00330522, 0.00338823, 0.00277699, 0.00276021, 0.00271578, 0.00276944, 0.00273087, 0.00239968, 0.00242232, 0.00228649, 0.00216575, 0.00194691, 0.00182617, 0.00189409, 0.00187145, 0.00159224, 0.0015696, 0.00170543, 0.00139604, 0.00156876, 0.00133567, 0.00113108,0.00113947, 0.00128285, 0.00105646, 0.000943271, 0.000837625, 0.00090554, 0.000928179, 0.000844326, 0.000724432, 0.000769709, 0.000671609, 0.00061124, 0.000664063, 0.00055087, 0.000505593, 0.00051314, 0.000482955, 0.00045277, 0.000384855, 0.000445224, 0.000407493, 0.00035467, 0.000301847, 0.000331186, 0.000294301, 0.000233931, 0.00015847, 0.000218839, 0.000166016, 0.000249024, 0.000120739, 0.000181108, 0.00015847, 9.81002e-05, 0.000150923, 0.000120739, 0.000188654, 0.000135831, 9.81002e-05, 6.03694e-05, 3.77309e-05, 9.0554e-05, 5.28232e-05, 6.79155e-05, 0.000120739, 0.000105646, 6.79155e-05, 8.30079e-05, 3.77309e-05, 4.5277e-05, 3.77309e-05, 1.50923e-05, 6.79155e-05, 3.77309e-05, 3.01847e-05, 7.54617e-06, 2.26385e-05, 1.50923e-05, 1.50923e-05, 7.54617e-06, 2.26385e-05, 3.01847e-05, 3.01847e-05, 0, 2.26385e-05, 3.01847e-05, 2.26385e-05, 2.26385e-05, 1.50923e-05, 1.50923e-05, 7.54617e-06, 1.50923e-05, 7.54617e-06, 1.50923e-05, 7.54617e-06, 3.77309e-05, 0, 1.50923e-05, 0, 1.50923e-05, 2.26385e-05, 0, 0, 7.54617e-06, 7.54617e-06, 0, 0, 7.54617e-06, 0, 0, 7.54617e-06, 0, 0, 7.54617e-06, 7.54617e-06, 7.54617e-06, 0, 0, 0, 0, 7.54617e-06, 7.54617e-06, 0, 0, 7.54617e-06, 0, 7.54617e-06, 0, 0, 0, 7.54617e-06, 0, 0, 0, 0, 0, 0, 7.54617e-06, 0, 0, 0, 7.54617e-06,};
  int i = (int)TMath::Nint((Amp+1.)/2);
  return val[i];
}

double pdf_g_h(double Amp) {
  double val[300] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0112101, 0.0374629, 0.0523139, 0.0620868, 0.0601705, 0.0633324, 0.055859, 0.0524097, 0.0483856, 0.046086, 0.0433075, 0.0402415, 0.0378461, 0.0347801, 0.0318099, 0.0285523, 0.0295104, 0.0223244, 0.0227077, 0.0199291, 0.0195458, 0.0190668, 0.0142761, 0.0124557, 0.0147552, 0.0114976, 0.00948548, 0.0095813, 0.00785666, 0.0081441, 0.00823992, 0.00613203, 0.00526971, 0.00526971, 0.00526971, 0.00354508, 0.0044074, 0.00229951, 0.00344927, 0.00258695, 0.00229951, 0.00191626, 0.00182045, 0.00162882, 0.00143719, 0.00229951, 0.00124557, 0.00114976, 0.00114976, 0.00153301, 0.000574878, 0.000479065, 0.000766504, 0.000191626, 0.000670691, 0.000479065, 0.000670691, 0.000287439, 0.000670691, 0.000479065, 0.000574878, 0.000383252, 0.000574878, 0.000287439, 0.000287439, 0, 9.5813e-05, 0.000383252, 9.5813e-05, 0.000191626, 9.5813e-05, 0.000191626, 0, 0, 0, 0, 9.5813e-05, 0, 9.5813e-05, 9.5813e-05, 0.000191626, 0, 0, 9.5813e-05, 9.5813e-05, 9.5813e-05, 0, 9.5813e-05, 0, 0, 0, 0, 0.000191626, 9.5813e-05, 0, 9.5813e-05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.5813e-05, 0, 9.5813e-05, 0, 0, 0, 0, 0, 0, 0, 9.5813e-05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.5813e-05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,};

  int i = (int)TMath::Nint((Amp+1.)/2);
  return val[i];
}
